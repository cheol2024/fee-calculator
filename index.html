<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>FIFA ìˆ˜ìˆ˜ë£Œ ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f5f5;
      padding: 30px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      border-radius: 12px;
      padding: 20px 30px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      color: #2c3e50;
    }
    label {
      display: block;
      margin: 15px 0 5px;
      font-weight: 500;
    }
    input[type="number"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    input[type="checkbox"] {
      transform: scale(1.5);
      margin-right: 10px;
      vertical-align: middle;
    }
    .price-note {
      font-size: 0.9em;
      color: #555;
      margin-bottom: 10px;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      width: 100%;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
    .result {
      margin-top: 25px;
      background: #ecf0f1;
      padding: 15px;
      border-radius: 10px;
    }
    .coupon-group {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ® FIFA ìˆ˜ìˆ˜ë£Œ ê³„ì‚°ê¸°</h1>

    <label>íŒë§¤í•  ì„ ìˆ˜ ìˆ˜ ì…ë ¥:</label>
    <input type="number" id="playerCount" min="1" placeholder="ì˜ˆ: 11" oninput="generatePriceInputs()" />

    <div id="priceInputs"></div>

    <label><input type="checkbox" id="topClass" /> TOP CLASS (20%)</label>
    <label><input type="checkbox" id="pcRoom" /> PCë°© í˜œíƒ (30%)</label>

    <label>ìˆ˜ìˆ˜ë£Œ ì¿ í° ê°œìˆ˜ ì…ë ¥:</label>
    <div id="couponContainer">
      <div class="coupon-group"><input type="number" id="coupon40" placeholder="40% ì¿ í° ì¥ìˆ˜" /></div>
      <div class="coupon-group"><input type="number" id="coupon30" placeholder="30% ì¿ í° ì¥ìˆ˜" /></div>
    </div>
    <button type="button" onclick="showMoreCoupons()">+ ì¶”ê°€ ì¿ í° ì…ë ¥</button>

    <div id="extraCoupons" style="display:none">
      <div class="coupon-group"><input type="number" id="coupon50" placeholder="50% ì¿ í° ì¥ìˆ˜" /></div>
      <div class="coupon-group"><input type="number" id="coupon35" placeholder="35% ì¿ í° ì¥ìˆ˜" /></div>
      <div class="coupon-group"><input type="number" id="coupon25" placeholder="25% ì¿ í° ì¥ìˆ˜" /></div>
      <div class="coupon-group"><input type="number" id="coupon20" placeholder="20% ì¿ í° ì¥ìˆ˜" /></div>
      <div class="coupon-group"><input type="number" id="coupon10" placeholder="10% ì¿ í° ì¥ìˆ˜" /></div>
    </div>

    <button onclick="calculateTotal()">ì´ ê³„ì‚°í•˜ê¸°</button>

    <div class="result" id="result"></div>
  </div>

  <script>
    function showMoreCoupons() {
      document.getElementById("extraCoupons").style.display = "block";
    }

    function generatePriceInputs() {
      const count = parseInt(document.getElementById("playerCount").value);
      const container = document.getElementById("priceInputs");
      container.innerHTML = "";
      for (let i = 0; i < count; i++) {
        const label = document.createElement("label");
        label.innerText = `${i + 1}ë²ˆ ì„ ìˆ˜ ê°€ê²© (ì–µ BP):`;

        const input = document.createElement("input");
        input.type = "number";
        input.className = "playerPrice";
        input.placeholder = `ì„ ìˆ˜ ${i + 1}`;
        input.dataset.index = i;
        input.oninput = updateReadable;

        const note = document.createElement("div");
        note.className = "price-note";
        note.id = `note-${i}`;

        container.appendChild(label);
        container.appendChild(input);
        container.appendChild(note);
      }
    }

    function updateReadable(e) {
      const inputVal = Number(e.target.value);
      const value = inputVal * 100000000; // ì–µ ë‹¨ìœ„ â†’ BP ë‹¨ìœ„
      const note = document.getElementById(`note-${e.target.dataset.index}`);
      if (!isNaN(value) && value > 0) {
        const ì¡° = Math.floor(value / 1_0000_0000_0000);
        const ì–µ = Math.floor((value % 1_0000_0000_0000) / 1_0000_0000);
        let text = '';
        if (ì¡° > 0) text += `${ì¡°}ì¡°`;
        if (ì–µ > 0) text += ` ${ì–µ}ì–µ`;
        note.textContent = `â¡ ${text.trim()} BP`;
      } else {
        note.textContent = '';
      }
    }

    function calculateTotal() {
      const prices = Array.from(document.getElementsByClassName("playerPrice"))
        .map(input => Number(input.value) * 100000000) // ì–µ ë‹¨ìœ„ â†’ BP ë‹¨ìœ„ ë³€í™˜
        .filter(val => !isNaN(val))
        .sort((a, b) => b - a); // ê³ ê°€ ì„ ìˆ˜ë¶€í„° ì •ë ¬

      const topClass = document.getElementById("topClass").checked;
      const pcRoom = document.getElementById("pcRoom").checked;

      const couponRates = [50, 40, 35, 30, 25, 20, 10];
      const coupons = {};
      couponRates.forEach(rate => {
        const input = document.getElementById(`coupon${rate}`);
        if (input) {
          coupons[rate] = parseInt(input.value) || 0;
        }
      });

      let totalReceive = 0;

      prices.forEach(price => {
        let baseFee = price * 0.4;
        let discount = 0;

        if (topClass) discount += baseFee * 0.2;
        if (pcRoom) discount += baseFee * 0.3;

        for (let rate of couponRates) {
          if (coupons[rate] > 0) {
            discount += baseFee * (rate / 100);
            coupons[rate]--;
            break;
          }
        }

        const fee = baseFee - discount;
        totalReceive += price - fee;
      });

      document.getElementById("result").innerHTML = `
        <strong>ì´ ì‹¤ìˆ˜ë ¹ ê¸ˆì•¡:</strong> <span style="color: green; font-size: 1.2em;">${formatReadable(totalReceive)} BP</span>
      `;
    }

    function formatReadable(val) {
      const ì¡° = Math.floor(val / 1_0000_0000_0000);
      const ì–µ = Math.floor((val % 1_0000_0000_0000) / 1_0000_0000);
      let result = '';
      if (ì¡° > 0) result += `${ì¡°}ì¡°`;
      if (ì–µ > 0) result += ` ${ì–µ}ì–µ`;
      return result.trim();
    }
  </script>
</body>
</html>
